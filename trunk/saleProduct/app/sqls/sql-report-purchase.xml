<?xml version="1.0" encoding="UTF-8"?>
<properties>
	
    <entry key="sql_rp_loadTotal">
	<![CDATA[
		SELECT t1.NAME AS PD,t1.U AS NAME,t1.C FROM  (
		  SELECT t.STATUS AS NAME, COUNT(1) AS C, 'Total' AS U  FROM (  	
			SELECT DISTINCT DATE_FORMAT( sppdt.CREATE_TIME, "%y%m%d" ) AS ACTION_TIME, 
				sppdt.PD_ID , 
				sppdt.STATUS 
			FROM 
			  sc_purchase_product spp,
			  sc_purchase_plan_details_track sppdt
			WHERE spp.ID = sppdt.PD_ID
			 AND sppdt.STATUS IN (45,51,49,50,60,80)
			 AND sppdt.CREATE_TIME >= '{@#startTime#}'
			 {@ AND sppdt.CREATE_TIME <= '#endTime# 24:00:00'}
			ORDER BY create_time DESC 
		  ) t
		  GROUP BY t.STATUS
	) t1
	 ]]>	  
    </entry>
    
    <entry key="sql_rp_loadCostTotal">
	<![CDATA[
	SELECT t1.NAME AS PD,t1.U AS NAME,t1.C FROM  (
		  SELECT t.STATUS AS NAME, COUNT(1) AS C, 'Total' AS U  FROM (  	
			SELECT DISTINCT DATE_FORMAT( sppdt.CREATE_TIME, "%y%m%d" ) AS ACTION_TIME, 
				sppdt.PD_ID,
				spp.EVAL_COST AS STATUS
			FROM 
			  sc_purchase_product spp,
			  sc_purchase_plan_details_track sppdt
			WHERE spp.ID = sppdt.PD_ID
			 AND sppdt.STATUS IN (51)
			 AND sppdt.CREATE_TIME >= '{@#startTime#}'
			 {@ AND sppdt.CREATE_TIME <= '#endTime# 24:00:00'}
			ORDER BY create_time DESC 
		  ) t
		  GROUP BY t.STATUS
	) t1
	 ]]>	  
    </entry>
    
    <!-- 中止采购交易 -->
    <entry key="sql_rp_loadTerminalDeal">
	<![CDATA[
  	select count(1) as C from (
			SELECT DISTINCT  
				sppdt.PD_ID
			FROM 
			  sc_purchase_product spp,
			  sc_purchase_plan_details_track sppdt
			WHERE spp.ID = sppdt.PD_ID
			 AND sppdt.STATUS IN (80)
			 AND spp.IS_TERMINATION = 1
			 AND sppdt.CREATE_TIME >= '{@#startTime#}'
			 {@ AND sppdt.CREATE_TIME <= '#endTime# 24:00:00'}
  ) t
	 ]]>	  
    </entry>
    
    <!-- 交期统计交易 -->
    <entry key="sql_rp_loadDelivery">
	<![CDATA[
  	SELECT t1.NAME AS PD,t1.U AS NAME,t1.C FROM  (
		  SELECT t.STATUS AS NAME, COUNT(1) AS C, 'Total' AS U  FROM (  	
			SELECT DISTINCT DATE_FORMAT( sppdt.CREATE_TIME, "%y%m%d" ) AS ACTION_TIME, 
				sppdt.PD_ID,
				spp.EVAL_DELIVERY AS STATUS
			FROM
			  sc_purchase_product spp,
			  sc_purchase_plan_details_track sppdt
			WHERE spp.ID = sppdt.PD_ID
			 AND sppdt.STATUS IN (51)
			 AND sppdt.CREATE_TIME >= '{@#startTime#}'
			 {@ AND sppdt.CREATE_TIME <= '#endTime# 24:00:00'}
			ORDER BY create_time DESC 
		  ) t
		  GROUP BY t.STATUS
	) t1
	 ]]>	  
    </entry>
</properties>